(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[942],{1987:(e,a,t)=>{"use strict";t.d(a,{default:()=>m});var r=t(5155),s=t(5695),n=t(2115),i=t(5799),o=t(9946);let l=(0,o.A)("calendar-plus",[["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M21 12.598V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8.5",key:"1glfrc"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]]),c=(0,o.A)("clock-3",[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var d=t(7580);let u=(0,o.A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function h(e){let{eventoId:a}=e,[t,s]=(0,n.useState)([]),[o,h]=(0,n.useState)([]),[m,x]=(0,n.useState)(null),[p,g]=(0,n.useState)([]),[y,f]=(0,n.useState)(""),[v,j]=(0,n.useState)(""),[N,b]=(0,n.useState)(""),[k,w]=(0,n.useState)(""),[C,S]=(0,n.useState)(""),[_,E]=(0,n.useState)(null),[R,T]=(0,n.useState)(""),[A,D]=(0,n.useState)(""),[P,M]=(0,n.useState)(""),[L,O]=(0,n.useState)(null),[z,U]=(0,n.useState)(""),J="https://backendsebas-ehe6b0e6eebbhjhe.mexicocentral-01.azurewebsites.net";(0,n.useEffect)(()=>{fetch("".concat(J,"/turnos/evento/").concat(a),{credentials:"include"}).then(e=>e.json()).then(e=>s(e)),fetch("".concat(J,"/usuarios"),{credentials:"include"}).then(e=>e.json()).then(e=>h(e))},[a]);let G=async e=>{x(e);let a=await fetch("".concat(J,"/turnos/usuarios/").concat(e),{credentials:"include"});g(await a.json())},H=async()=>{if(!y||!v)return void i.oR.error("Seleccione usuario y rol");(await fetch("".concat(J,"/turnos/asignar"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({turno_id:m,usuario_id:y,rol_asignado:v})})).ok?(i.oR.success("Usuario asignado"),f(""),j(""),G(m)):i.oR.error("Error al asignar usuario")},I=async()=>{if(!N||!k||!C)return void i.oR.error("Complete todos los campos del turno");let e=await fetch("".concat(J,"/turnos"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({evento_id:Number(a),fecha:N,hora_inicio:k,hora_fin:C,asignaciones:[]})});if(e.ok){i.oR.success("Turno creado"),b(""),w(""),S("");let a=await e.json();s(e=>[...e,{id:a.turno_id,fecha:N,hora_inicio:k,hora_fin:C}])}else i.oR.error("Error al crear turno")},W=async e=>{confirm("\xbfDesea eliminar este turno?")&&((await fetch("".concat(J,"/turnos/").concat(e),{method:"DELETE",credentials:"include"})).ok?(i.oR.success("Turno eliminado"),s(a=>a.filter(a=>a.id!==e)),m===e&&x(null)):i.oR.error("Error al eliminar turno"))},q=async e=>{(await fetch("".concat(J,"/turnos/").concat(e),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({fecha:R,hora_inicio:A,hora_fin:P})})).ok?(i.oR.success("Turno actualizado"),s(a=>a.map(a=>a.id===e?{...a,fecha:R,hora_inicio:A,hora_fin:P}:a)),E(null)):i.oR.error("Error al actualizar turno")},V=async e=>{confirm("\xbfEliminar esta asignaci\xf3n?")&&((await fetch("".concat(J,"/turnos/asignacion/").concat(e),{method:"DELETE",credentials:"include"})).ok?(i.oR.success("Asignaci\xf3n eliminada"),G(m)):i.oR.error("Error al eliminar asignaci\xf3n"))},Z=(e,a)=>{O(e),U(a)},$=async e=>{(await fetch("".concat(J,"/turnos/asignacion/").concat(e),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({rol_asignado:z})})).ok?(i.oR.success("Rol actualizado"),O(null),G(m)):i.oR.error("Error al actualizar el rol")};return(0,r.jsxs)("div",{className:"p-6 max-w-5xl mx-auto space-y-8",children:[(0,r.jsxs)("section",{className:"bg-white border rounded-lg shadow p-6 space-y-4",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-primario flex items-center gap-2",children:[(0,r.jsx)(l,{className:"w-5 h-5"}),"Crear nuevo turno"]}),(0,r.jsxs)("div",{className:"grid sm:grid-cols-3 gap-4",children:[(0,r.jsx)("input",{type:"date",value:N,onChange:e=>b(e.target.value),className:"w-full border rounded px-3 py-2"}),(0,r.jsx)("input",{type:"time",value:k,onChange:e=>w(e.target.value),className:"w-full border rounded px-3 py-2"}),(0,r.jsx)("input",{type:"time",value:C,onChange:e=>S(e.target.value),className:"w-full border rounded px-3 py-2"})]}),(0,r.jsx)("button",{onClick:I,className:"btn-personalizado text-white px-5 py-2 rounded transition w-fit",children:"Guardar turno"})]}),(0,r.jsxs)("section",{children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-primario mb-4 flex items-center gap-2",children:[(0,r.jsx)(c,{className:"w-5 h-5"}),"Turnos existentes"]}),(0,r.jsx)("ul",{className:"space-y-4",children:t.map(e=>(0,r.jsxs)("li",{className:"bg-white border rounded-lg shadow p-5",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[_===e.id?(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,r.jsx)("input",{type:"date",value:R,onChange:e=>T(e.target.value),className:"border p-1 rounded"}),(0,r.jsx)("input",{type:"time",value:A,onChange:e=>D(e.target.value),className:"border p-1 rounded"}),(0,r.jsx)("input",{type:"time",value:P,onChange:e=>M(e.target.value),className:"border p-1 rounded"}),(0,r.jsx)("button",{onClick:()=>q(e.id),className:"text-green-600 hover:underline text-sm",children:"Guardar"}),(0,r.jsx)("button",{onClick:()=>E(null),className:"text-gray-500 hover:underline text-sm",children:"Cancelar"})]}):(0,r.jsxs)("p",{className:"text-gray-800",children:["\uD83D\uDCC5 ",new Date(e.fecha).toLocaleDateString("es-CR",{day:"numeric",month:"long",year:"numeric"}),"\xb7 \uD83D\uDD52 ",new Date("1970-01-01T".concat(e.hora_inicio)).toLocaleTimeString("es-CR",{hour:"2-digit",minute:"2-digit"})," -",new Date("1970-01-01T".concat(e.hora_fin)).toLocaleTimeString("es-CR",{hour:"2-digit",minute:"2-digit"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>G(e.id),className:"text-blue-600 hover:underline text-sm",children:"Ver / asignar usuarios"}),(0,r.jsx)("button",{onClick:()=>W(e.id),className:"text-red-600 hover:underline text-sm",children:"Eliminar turno"}),(0,r.jsx)("button",{onClick:()=>{E(e.id),T(e.fecha),D(e.hora_inicio),M(e.hora_fin)},className:"text-orange-600 hover:underline text-sm",children:"Editar turno"})]})]}),m===e.id&&(0,r.jsxs)("div",{className:"mt-4 space-y-4 border-t pt-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-semibold flex items-center gap-2",children:[(0,r.jsx)(d.A,{className:"w-4 h-4"})," Usuarios asignados:"]}),0===p.length?(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Sin asignaciones"}):(0,r.jsx)("ul",{className:"space-y-2 text-sm",children:p.map(e=>(0,r.jsxs)("li",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[(0,r.jsxs)("span",{children:[e.nombre," â€” ",(0,r.jsx)("span",{className:"italic",children:e.rol_asignado})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>Z(e.id,e.rol_asignado),className:"text-orange-500 text-xs hover:underline",children:"Editar rol"}),(0,r.jsx)("button",{onClick:()=>V(e.id),className:"text-red-500 text-xs hover:underline",children:"Eliminar"})]}),L===e.id&&(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:z,onChange:e=>U(e.target.value),className:"border p-1 rounded text-xs"}),(0,r.jsx)("button",{onClick:()=>$(e.id),className:"text-green-600 text-xs hover:underline",children:"Guardar"}),(0,r.jsx)("button",{onClick:()=>O(null),className:"text-gray-500 text-xs hover:underline",children:"Cancelar"})]})]},e.id))})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("p",{className:"font-semibold flex items-center gap-2",children:[(0,r.jsx)(u,{className:"w-4 h-4"})," Asignar nuevo usuario"]}),(0,r.jsxs)("select",{value:y,onChange:e=>f(e.target.value),className:"border p-2 rounded w-full",children:[(0,r.jsx)("option",{value:"",children:"Seleccione usuario"}),o.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.nombre," (",e.rol,")"]},e.id))]}),(0,r.jsx)("input",{type:"text",value:v,onChange:e=>j(e.target.value),placeholder:"Ej: Cajero, Apoyo, Supervisor",className:"border p-2 rounded w-full"}),(0,r.jsx)("button",{onClick:H,className:"btn-personalizado text-white px-4 py-2 rounded transition",children:"Asignar usuario"})]})]})]},e.id))})]})]})}function m(){let e=(0,s.useSearchParams)().get("eventoId");return e?(0,r.jsx)(h,{eventoId:e}):(0,r.jsxs)("div",{className:"p-6 text-red-600",children:["Debe indicar un evento v\xe1lido: ",(0,r.jsx)("code",{children:"?eventoId=123"})]})}},2038:(e,a,t)=>{Promise.resolve().then(t.bind(t,1987))},5695:(e,a,t)=>{"use strict";var r=t(8999);t.o(r,"usePathname")&&t.d(a,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(a,{useSearchParams:function(){return r.useSearchParams}})},7580:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(9946).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},9946:(e,a,t)=>{"use strict";t.d(a,{A:()=>u});var r=t(2115);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,a,t)=>t?t.toUpperCase():a.toLowerCase()),i=e=>{let a=n(e);return a.charAt(0).toUpperCase()+a.slice(1)},o=function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return a.filter((e,a,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===a).join(" ").trim()},l=e=>{for(let a in e)if(a.startsWith("aria-")||"role"===a||"title"===a)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,r.forwardRef)((e,a)=>{let{color:t="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:d="",children:u,iconNode:h,...m}=e;return(0,r.createElement)("svg",{ref:a,...c,width:s,height:s,stroke:t,strokeWidth:i?24*Number(n)/Number(s):n,className:o("lucide",d),...!u&&!l(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[a,t]=e;return(0,r.createElement)(a,t)}),...Array.isArray(u)?u:[u]])}),u=(e,a)=>{let t=(0,r.forwardRef)((t,n)=>{let{className:l,...c}=t;return(0,r.createElement)(d,{ref:n,iconNode:a,className:o("lucide-".concat(s(i(e))),"lucide-".concat(e),l),...c})});return t.displayName=i(e),t}}},e=>{var a=a=>e(e.s=a);e.O(0,[799,441,684,358],()=>a(2038)),_N_E=e.O()}]);