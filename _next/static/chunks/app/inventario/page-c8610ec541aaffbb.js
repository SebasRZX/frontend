(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[360],{786:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,O:()=>o});var a=r(5155),s=r(2115);let c=(0,s.createContext)();function o(e){let{children:t}=e,[r,o]=(0,s.useState)(null),[n,i]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("https://backendsebas-ehe6b0e6eebbhjhe.mexicocentral-01.azurewebsites.net","/usuarios/verificar"),{credentials:"include"});if(e.ok){let t=await e.json();o(t.usuario)}else o(null)}catch(e){console.error("Error verificando sesi\xf3n:",e)}finally{i(!1)}})()},[]),(0,a.jsx)(c.Provider,{value:{usuario:r,setUsuario:o,cargando:n},children:t})}function n(){return(0,s.useContext)(c)}},2525:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9946).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},4416:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5695:(e,t,r)=>{"use strict";var a=r(8999);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},7826:(e,t,r)=>{Promise.resolve().then(r.bind(r,7883))},7883:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var a=r(5155),s=r(2115),c=r(5695),o=r(9946);let n=(0,o.A)("ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),i=(0,o.A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var l=r(9917),d=r(2525),u=r(4416);function m(e){let{producto:t,onCerrar:r,onActualizado:c}=e,[o,n]=(0,s.useState)({nombre:"",descripcion:"",precio:"",cantidad:"",categoria_id:""}),[i,l]=(0,s.useState)([]),[d,m]=(0,s.useState)(null),x="https://backendsebas-ehe6b0e6eebbhjhe.mexicocentral-01.azurewebsites.net";(0,s.useEffect)(()=>{t&&n({nombre:t.nombre||"",descripcion:t.descripcion||"",precio:t.precio||"",cantidad:t.cantidad||"",categoria_id:t.categoria_id||""}),(async()=>{let e=await fetch("".concat(x,"/categorias"));l(await e.json())})()},[t]);let h=e=>{let{name:t,value:r}=e.target;n(e=>({...e,[t]:r}))},b=async e=>{e.preventDefault();let a=new FormData;for(let e in o)a.append(e,o[e]);d&&a.append("imagen",d);try{(await fetch("".concat(x,"/productos/").concat(t.id),{method:"PUT",credentials:"include",body:a})).ok?(c(),r()):console.error("Error al actualizar producto")}catch(e){console.error("Error al enviar formulario:",e)}};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg w-full max-w-xl relative max-h-[90vh] overflow-y-auto animate-fade-in",children:[(0,a.jsx)("button",{onClick:r,className:"absolute top-3 right-3 text-gray-500 hover:text-red-500",children:(0,a.jsx)(u.A,{size:20})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Editar Producto"}),(0,a.jsxs)("form",{onSubmit:b,className:"grid grid-cols-1 gap-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del producto"}),(0,a.jsx)("input",{type:"text",name:"nombre",value:o.nombre,onChange:h,required:!0,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,a.jsx)("textarea",{name:"descripcion",value:o.descripcion,onChange:h,rows:3,className:"w-full p-2 border rounded-md resize-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio"}),(0,a.jsx)("input",{type:"number",name:"precio",value:o.precio,onChange:h,required:!0,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad"}),(0,a.jsx)("input",{type:"number",name:"cantidad",value:o.cantidad,onChange:h,required:!0,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categor\xeda"}),(0,a.jsxs)("select",{name:"categoria_id",value:o.categoria_id,onChange:h,required:!0,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Seleccione una categor\xeda"}),i.map(e=>(0,a.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Imagen actual"}),t.imagen_url?(0,a.jsx)("img",{src:"".concat(x,"/uploads/").concat(t.imagen_url),alt:"Imagen del producto",className:"w-24 h-24 object-cover rounded-md border mb-2"}):(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Este producto no tiene imagen."}),(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mt-2 mb-1",children:"Cambiar imagen"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>m(e.target.files[0]),className:"w-full p-2 border rounded-md"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-4",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 border rounded hover:bg-gray-100",children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Guardar cambios"})]})]})]})]})})}function x(){let[e,t]=(0,s.useState)([]),[r,c]=(0,s.useState)(null),[o,u]=(0,s.useState)(!1),x="https://backendsebas-ehe6b0e6eebbhjhe.mexicocentral-01.azurewebsites.net";(0,s.useEffect)(()=>{h()},[o]);let h=async()=>{try{let e=await fetch(o?"".concat(x,"/productos/inactivos"):"".concat(x,"/productos"),{credentials:"include"}),r=await e.json();t(r)}catch(e){console.error("Error al cargar productos:",e)}},b=async e=>{if(confirm("\xbfDesea eliminar este producto?"))try{await fetch("".concat(x,"/productos/").concat(e),{method:"DELETE",credentials:"include"}),h()}catch(e){console.error("Error al eliminar:",e)}},p=async e=>{if(confirm("\xbfDesea restaurar este producto?"))try{await fetch("".concat(x,"/productos/restaurar/").concat(e),{method:"PUT",credentials:"include"}),h()}catch(e){console.error("Error al restaurar producto:",e)}},g=e=>0===e?"bg-red-100 text-red-700":e<5?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700";return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:o?"Productos inactivos":"Productos activos"}),(0,a.jsx)("button",{onClick:()=>u(!o),className:"btn-personalizado text-sm text-white px-4 py-2 rounded-lg shadow",children:o?"Ver activos":"Ver inactivos"})]}),0===e.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center text-gray-600 py-16 col-span-full",children:[(0,a.jsx)(n,{size:48,className:"mb-4 text-red-400"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:o?"No hay productos inactivos para mostrar.":"No hay productos activos disponibles."})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-6",children:e.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden transition hover:shadow-lg border border-gray-200",children:[e.imagen_url&&(0,a.jsx)("img",{src:"".concat(x,"/uploads/").concat(e.imagen_url),alt:e.nombre,className:"w-full h-40 object-cover"}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-1",children:e.nombre}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:e.descripcion}),(0,a.jsxs)("p",{className:"text-gray-800 font-medium text-sm",children:["Precio: ",(0,a.jsxs)("span",{className:"text-primario font-bold",children:["â‚¡",e.precio]})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Categor\xeda: ",e.categoria||"N/A"]}),(0,a.jsxs)("div",{className:"text-xs inline-block px-2 py-1 mt-2 rounded-full font-medium ".concat(g(e.cantidad)),children:["Stock: ",e.cantidad]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end gap-2",children:o?(0,a.jsxs)("button",{onClick:()=>p(e.id),className:"flex items-center gap-1 px-3 py-1 text-sm text-green-600 hover:text-white hover:bg-green-600 border border-green-600 rounded transition",children:[(0,a.jsx)(i,{size:16}),"Restaurar"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>c(e),className:"flex items-center gap-1 px-3 py-1 text-sm text-blue-600 hover:text-white hover:bg-blue-600 border border-blue-600 rounded transition",children:[(0,a.jsx)(l.A,{size:16}),"Editar"]}),(0,a.jsxs)("button",{onClick:()=>b(e.id),className:"flex items-center gap-1 px-3 py-1 text-sm text-red-600 hover:text-white hover:bg-red-600 border border-red-600 rounded transition",children:[(0,a.jsx)(d.A,{size:16}),"Eliminar"]})]})})]})]},e.id))}),r&&(0,a.jsx)(m,{producto:r,onCerrar:()=>c(null),onActualizado:h})]})}var h=r(786);function b(){let{usuario:e,cargando:t}=(0,h.A)(),r=(0,c.useRouter)();return((0,s.useEffect)(()=>{t||e&&["admin","coordinador"].includes(e.rol)||r.push("/")},[e,t,r]),t||!e)?null:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Productos registrados"}),(0,a.jsx)(x,{})]})}},9917:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9946).A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]])},9946:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var a=r(2115);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),c=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),o=e=>{let t=c(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},i=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:c=2,absoluteStrokeWidth:o,className:d="",children:u,iconNode:m,...x}=e;return(0,a.createElement)("svg",{ref:t,...l,width:s,height:s,stroke:r,strokeWidth:o?24*Number(c)/Number(s):c,className:n("lucide",d),...!u&&!i(x)&&{"aria-hidden":"true"},...x},[...m.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let r=(0,a.forwardRef)((r,c)=>{let{className:i,...l}=r;return(0,a.createElement)(d,{ref:c,iconNode:t,className:n("lucide-".concat(s(o(e))),"lucide-".concat(e),i),...l})});return r.displayName=o(e),r}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(7826)),_N_E=e.O()}]);